---
title: "Acd_Am-Dmax"
author: "Balam"
date: "2023-10-19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
getwd()
setwd("/home/sdv/m1isdd/gbalamtekin/Documents/Projet_asymetrie_Biostat/")
```

```{r}
data <- read.table("DATA/Dmax/distMax_alldimers.txt", header = TRUE)
datab <- read.table("DATA/Dmax/distMax_alldimers_backbone.txt", header = TRUE) 

par(mfrow=c(1, 2))

hist(datab$distance_max_interChain[grepl("ALA", datab$atom_nm)], xlim=c(0,5), ylim=c(0,4000), breaks = 5, col = "blue", main = "Superposed Histograms")
hist(data$distance_max_interChain[grepl("ALA", data$atom_nm)], xlim=c(0,5), ylim=c(0,4000), breaks = 5, col = "red", add = FALSE)

hist(datab$distance_max_interChain[grepl("GLY", datab$atom_nm)], breaks = 20, col = "blue", main = "Superposed Histograms")
hist(data$distance_max_interChain[grepl("GLY", data$atom_nm)], breaks = 20, col = "red", add = FALSE)

hist(datab$distance_max_interChain[grepl("ARG", datab$atom_nm)], breaks = 20, col = "blue", main = "Superposed Histograms")
hist(data$distance_max_interChain[grepl("ARG", data$atom_nm)], breaks = 20, col = "red", add = FALSE)

hist(datab$distance_max_interChain[grepl("GLU", datab$atom_nm)], breaks = 20, col = "blue", main = "Superposed Histograms")
hist(data$distance_max_interChain[grepl("GLU", data$atom_nm)], breaks = 20, col = "red", add = FALSE)

hist(datab$distance_max_interChain[grepl("TYR", datab$atom_nm)], breaks = 20, col = "blue", main = "Superposed Histograms")
hist(data$distance_max_interChain[grepl("TYR", data$atom_nm)], breaks = 20, col = "red", add = FALSE)

hist(datab$distance_max_interChain[grepl("LYS", datab$atom_nm)], breaks = 20, col = "blue", main = "Superposed Histograms")
hist(data$distance_max_interChain[grepl("LYS", data$atom_nm)], breaks = 20, col = "red", add = FALSE)

hist(datab$distance_max_interChain[grepl("ASP", datab$atom_nm)], breaks = 20, col = "blue", main = "Superposed Histograms")
hist(data$distance_max_interChain[grepl("ASP", data$atom_nm)], breaks = 20, col = "red", add = FALSE)

hist(datab$distance_max_interChain[grepl("CYS", datab$atom_nm)], breaks = 20, col = "blue", main = "Superposed Histograms")
hist(data$distance_max_interChain[grepl("CYS", data$atom_nm)], breaks = 20, col = "red", add = FALSE)

hist(datab$distance_max_interChain[grepl("PHE", datab$atom_nm)], breaks = 20, col = "blue", main = "Superposed Histograms")
hist(data$distance_max_interChain[grepl("PHE", data$atom_nm)], breaks = 20, col = "red", add = FALSE)

hist(datab$distance_max_interChain[grepl("LEU", datab$atom_nm)], breaks = 20, col = "blue", main = "Superposed Histograms")
hist(data$distance_max_interChain[grepl("LEU", data$atom_nm)], breaks = 20, col = "red", add = TRUE)

hist(datab$distance_max_interChain[grepl("ILE", datab$atom_nm)], breaks = 20, col = "blue", main = "Superposed Histograms")
hist(data$distance_max_interChain[grepl("ILE", data$atom_nm)], breaks = 20, col = "red", add = FALSE)

hist(datab$distance_max_interChain[grepl("VAL", datab$atom_nm)], breaks = 20, col = "blue", main = "Superposed Histograms")
hist(data$distance_max_interChain[grepl("VAL", data$atom_nm)], breaks = 20, col = "red", add = FALSE)

hist(datab$distance_max_interChain[grepl("PRO", datab$atom_nm)], breaks = 20, col = "blue", main = "Superposed Histograms")
hist(data$distance_max_interChain[grepl("PRO", data$atom_nm)], breaks = 20, col = "red", add = FALSE)

hist(datab$distance_max_interChain[grepl("SER", datab$atom_nm)], breaks = 20, col = "blue", main = "Superposed Histograms")
hist(data$distance_max_interChain[grepl("SER", data$atom_nm)], breaks = 20, col = "red", add = FALSE)

hist(datab$distance_max_interChain[grepl("ASN", datab$atom_nm)], breaks = 20, col = "blue", main = "Superposed Histograms")
hist(data$distance_max_interChain[grepl("ASN", data$atom_nm)], breaks = 20, col = "red", add = FALSE)

hist(datab$distance_max_interChain[grepl("GLN", datab$atom_nm)], breaks = 20, col = "blue", main = "Superposed Histograms")
hist(data$distance_max_interChain[grepl("GLN", data$atom_nm)], breaks = 20, col = "red", add = FALSE)

hist(datab$distance_max_interChain[grepl("THR", datab$atom_nm)], breaks = 20, col = "blue", main = "Superposed Histograms")
hist(data$distance_max_interChain[grepl("THR", data$atom_nm)], breaks = 20, col = "red", add = FALSE)
```

```{r}
x <- data$distance_max_interChain[grepl("ALA", data$atom_nm)]

y <- datab$distance_max_interChain[grepl("ALA", datab$atom_nm)]

xdf <- as.data.frame(x)
ydf <-  as.data.frame(y)

t.test(xdf,ydf)

#faire globale

```

```{r}

# Convertir la variable "interior" en numérique (0/1)
data$first_chain <- ifelse(data$type_interface_FirstChain == "surface", 1, 0)

# Convertir la variable "surface" en numérique (0/1)
data$second_chain <- ifelse(data$type_interface_SecondChain == "surface", 1, 0)

data$combined_chain <- ifelse(data$first_chain == 1 & data$second_chain == 1, 1, 0)

data$combined_chain_0 <- ifelse(data$first_chain == 0 & data$second_chain == 0, 1, 0)

data_cor_final <- data.frame(
  distance_max_interChain = data$distance_max_interChain,
  first_chain = data$first_chain,
  second_chain = data$second_chain,
  combined_chain = data$combined_chain,
  combined_chain_0 = data$combined_chain_0
)[grepl("ALA", data$atom_nm), ]

t.test(data_cor_final$distance_max_interChain, data_cor_final$combined_chain)
t.test(data_cor_final$distance_max_interChain, data_cor_final$combined_chain_0)


```

